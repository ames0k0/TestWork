# Микросервис анализа финансовых транзакций

Необходимо разработать REST API микросервис для работы с транзакциями. Микросервис должен:
1. Принимать транзакции через REST API
2. Сохранять транзакции в базу данных
3. Рассчитывать статистику и выполнять алгоритмическую обработку данных
4. Предоставлять результаты анализа через API

### Функционал

1. POST /transactions — загрузка транзакции.
Входные данные
```json
{
  "transaction_id": "123456",
  "user_id": "user_001",
  "amount": 150.50,
  "currency": "USD",
  "timestamp": "2024-12-12T12:00:00"
}
```
Логика:
 - [ ] Сохраняет транзакцию в базу
 - [ ] Отправляет задачу в очередь на обновление статистики
Ответ:
```json
{
  "message": "Transaction received",
  "task_id": "abcd1234"
}
```

DELETE /transactions — удаление всех транзакций

Логика:
- [ ] Удаляет все транзакции из базы данных.
- [ ] Удаляет всю статистику и закешированные данные

GET /statistics — получение статистики по транзакциям

Логика:
- [ ] Общее количество транзакций.
- [ ] Среднюю сумму транзакции.
- [ ] Топ-3 самых крупных транзакций
```json
{
  "total_transactions": 25,
  "average_transaction_amount": 180.03,
  "top_transactions": [
    {"transaction_id": "1", "amount": 1000},
    {"transaction_id": "2", "amount": 850},
    {"transaction_id": "3", "amount": 500}
  ]
}
```

### Алгоритмы
- [ ] Реализовать алгоритм поиска топ-3 самых крупных транзакций с использованием алгоритма “Куча” (Heap Sort или аналог).
- [ ] Рассчитать среднее значение транзакций с минимальным использованием памяти (во время тестирования на микросервис будет добавлено 1000+ транзакций).

Требования к реализации

1. Технологии
  - [ ] FastAPI
  - [ ] SQLAlchemy + PostgreSQL
  - [ ] Docker/Docker Compose
  - [ ] Celery + Redis для асинхронной обработки
2. Информационная безопасность
  - [ ] Уникальность transaction_id
  - [ ] Валидация входных данных
  - [ ] Защита эндпоинтов с использованием API ключа. API ключ будет передаваться через заголовок
  - [ ] Authorization: ApiKey <your_api_key>
3. Тесты
  - [ ] Написать минимум три теста:
    - [ ] Тест эндпоинта POST /transactions (проверка добавления транзакции).
    - [ ] Тест эндпоинта DELETE /transactions
    - [ ] Тест эндпоинта GET /statistics (проверка корректности статистики).
4. Документация
  - [ ] Автоматическая генерация Swagger-документации через FastAPI

Результаты выполнения

1. Код должен быть размещен в репозитории (GitHub/GitLab).
2. Инструкция по запуску приложения:
  - [ ] Локально
  - [ ] Через Docker Compose
3. API-документация должна быть доступна по адресу /docs.